\section{Integration by Substitution} \label{S:4.6.Substitution}

\begin{goals}
\item How can we begin to find algebraic formulas for antiderivatives of more complicated algebraic functions?
\item How does the technique of $u$-substitution work to help us evaluate certain indefinite and definite integrals, and how does this process rely on identifying function-derivative pairs?
\end{goals}

%----------------------------------
% SUBSECTION INTRODUCTION
%----------------------------------
\subsection*{Introduction}

In Section~\ref{S:4.4.FTC}, we learned the key role that antiderivatives play in the the process of evaluating definite integrals exactly.  In particular, we know that if $F$ is any antiderivative of $f$, then
\[ \int_a^b f(x) \ dx = F(b) - F(a). \]
Furthermore, we realized that each elementary derivative rule developed in Chapter~\ref{CH:2} leads to a corresponding elementary antiderivative, as summarized in Table~\ref{T:4.4.Act2}.  Thus, if we wish to evaluate an integral such as 
\[ \int_0^1 \left(x^3 - \sqrt{x} + 5^x \right) \ dx, \]
it is straightforward to do so, since we can easily antidifferentiate $f(x) = x^3 - \sqrt{x} + 5^x.$ 

Because an algebraic formula for an antiderivative of $f$ enables us to evaluate the definite integral $\int_a^b f(x) \, dx$ exactly, we have a natural interest in being able to find such algebraic antiderivatives.\sidenote{Note that we emphasize \emph{algebraic} antiderivatives, as opposed to any antiderivative, since we know by the Fundamental Theorem of Calculus that $G(x) = \int_a^x f(t) \, dt$ is indeed an antiderivative of the given function $f$, but one that still involves a definite integral.}  

However, suppose we wish to evaluate the following indefinite integral.
\[ \int 2x \sqrt{1 + x^2} \ dx \]
Referencing Table~\ref{T:4.4.Act2}, notice that none of the antiderivatives involve a linear function of $x$ multiplied by a root function of $x$, which might tell us that none of the derivative rules we learned in Chapter~\ref{CH:2} give us a way to antidifferentiate the above integrand.  But in fact,
\[ \int 2x \sqrt{1 + x^2} \ dx = \frac{2}{3}\left( 1 + x^2 \right)^{3/2} + C.  \]

We know that we can easily check the evaluation of any indefinite integral simply by differentiating.  Doing so, we have
\begin{align*}
\frac{d}{dx}\left[ \frac{2}{3}\left( 1 + x^2 \right)^{3/2} + C \right] & = \frac{2}{3} \cdot \frac{3}{2} \left( 1 + x^2 \right)^{1/2} \cdot (2x) + 0 \\
& = \left( 1 + x^2 \right)^{1/2} \cdot (2x) \\
& = 2x \sqrt{1 + x^2}.
\end{align*}
While differentiating, we used a very specific rule from Chapter~\ref{CH:2}---the Chain Rule!  In fact, in every problem we encounter in this section, if we wish to check our integration by differentiating, we must use the Chain Rule.  Our goal in this section is to develop a method of integrating such that we ``undo'' the Chain Rule for differentiation.

\input{previews/4.6.PA1} % PREVIEW ACTIVITY

%----------------------------------------
% SUBSECTION U-SUBSTITUTION
%---------------------------------------
\subsection*{Reversing the Chain Rule: $u$-substitution} \index{$u$-substitution}

It is important to explicitly remember that differentiation and antidifferentiation are essentially inverse processes; that they are not quite inverse processes is due to the $+C$ that arises when antidifferentiating.  This close relationship enables us to take any known derivative rule and translate it to a corresponding rule for an indefinite integral.  

Restating the relationship defined by the Chain Rule given in Preview Activity~\ref{PA:4.6} in terms of an indefinite integral, we have
\begin{equation} \label{E:usubst} % EQUATION
\int f'(g(x)) g'(x) \, dx = f(g(x))+C.
\end{equation}
Hence, Equation~(\ref{E:usubst}) tells us that if we can take a given function and view its algebraic structure as $f'(g(x)) g'(x)$ for some appropriate choices of $f$ and $g$, then we can antidifferentiate the function by reversing the Chain Rule.  It is especially notable that both $g(x)$ and $g'(x)$ appear in the form of $f'(g(x)) g'(x)$; we will sometimes say that we seek to \emph{identify a function-derivative pair}\index{function-derivative pair} when trying to apply the rule in Equation~(\ref{E:usubst}).

In the situation where we can identify a function-derivative pair, we will introduce a new variable $u$ to represent the function $g(x)$.  Observing that with $u = g(x)$, it follows in Leibniz notation that $\frac{du}{dx} = g'(x)$, so that in terms of differentials\footnote{If we recall from the definition of the derivative that $\frac{du}{dx} \approx \frac{\triangle{u}}{\triangle{x}}$ and use the fact that $\frac{du}{dx} = g'(x)$, then we see that $g'(x) \approx \frac{\triangle{u}}{\triangle{x}}$.  Solving for $\triangle u$, $\triangle u \approx g'(x) \triangle x$.  It is this last relationship that, when expressed in ``differential'' notation enables us to write $du = g'(x) \, dx$ in the change of variable formula.}, $du = g'(x)\, dx$.  Now converting the indefinite integral of interest to a new one in terms of $u$, we have  
\[ \int f'(g(x)) g'(x) \ dx = \int f'(u) \ du. \]
To emphasize the importance of this concept, we restate it.
 
\concept{Integration by Substitution} %CONCEPT	
{Let $f$ and $g$ be differentiable functions, where the range of $g$ is an interval $I$ and the domain of $f$ is contained in $I$. Then \index{integration!by substitution}
\[ \int f'(g(x))g'(x)\ dx = f(g(x)) + C. \]
If $u = g(x)$, then $du = g'(x) \ dx$ and 
\[ \int f'(g(x))g'(x)\ dx = \int f'(u)\ du = f(u)+C = f(g(x))+C. \]
} % end concept

When $f'$ is an elementary function whose antiderivative is known, we can easily evaluate the indefinite integral in $u$, and then go on to determine the desired overall antiderivative of $f'(g(x)) g'(x)$.  We call this process \textbf{$u$-substitution}.  To see $u$-substitution at work, we consider the following example.

\input{examples/4-6_Eg1} % EXAMPLE

An essential observation about our work in Example~\ref{Ex:4.6.usub1} is that the $u$-substitution only worked because the function multiplying $\sin (x^4 + 3)$ was $4x^3$.  If instead that function was $x^2$ or $x^4$, the substitution process may not (and likely would not) have worked.  This is one of the primary challenges of antidifferentiation: slight changes in the integrand make tremendous differences.  For instance, we can use $u$-substitution with $u = x^2$ and $du = 2x \ dx$ to find that
\begin{eqnarray*}
\int xe^{x^2} \ dx & = & \int e^u \cdot \frac{1}{2} \ du \\
& = & \frac{1}{2} \int e^u \, du \\
& = & \frac{1}{2} e^u + C \\
& = & \frac{1}{2} e^{x^2} + C.
\end{eqnarray*}
If, however, we consider the similar indefinite integral
\[ \int e^{x^2} \ dx, \]
the missing $x$ to multiply $e^{x^2}$ makes the $u$-substitution $u = x^2$ no longer possible.  Hence, part of the lesson of $u$-substitution is just how specialized the process is: it only applies to situations where, up to a missing constant, the integrand that is present is the result of applying the Chain Rule to a different, related function.

Let's look at some more examples of $u$-substitution.

\input{examples/4-6_Eg2} % EXAMPLE

Not all integrals that benefit from substitution have a clear ``inside'' function. Several of the following examples will demonstrate ways in which this occurs.

\input{examples/4-6_Eg3} % EXAMPLE

Do not be afraid to experiment; when given an integral to evaluate, it is often beneficial to think ``If I let $u$ be \textit{this}, then $du$ must be \textit{that} \ldots'' and see if this helps simplify the integral at all.

\input{examples/4-6_Eg4} % EXAMPLE

The next two examples will help fill in some missing pieces of our antiderivative knowledge. We know the antiderivatives of the sine and cosine functions; what about the other standard functions tangent, cotangent, secant and cosecant? We discover these next.

\input{examples/4-6_Eg5} % EXAMPLE

\input{examples/4-6_Eg6} % EXAMPLE

We can use similar techniques to those used in Examples \ref{eg:4.6.usub5} and \ref{eg:4.6.usub6} to find antiderivatives of $\cot x$ and $\csc x$ (which the reader can explore in the exercises.)

\input{activities/4.6.Act1} % ACTIVITY

%-----------------------------------------------------
% SUBSECTION U-SUBSTITUTION WITH DEFINITE INTEGRALS
%-----------------------------------------------------
\subsection*{Evaluating Definite Integrals via $u$-substitution}

This section has focused on $u$-substitution as a means to evaluate indefinite integrals of functions that can be written, up to a constant multiple, in the form $f(g(x))g'(x)$.  However, much of the time integration is used in the context of definite integrals involving such functions. We need to be careful with the corresponding limits of integration.  Consider, for instance, the definite integral
\[ \int_2^5 xe^{x^2} \ dx. \]
Whenever we write a definite integral, it is implicit that the limits of integration correspond to the variable of integration.  To be more explicit, observe that
\[ \int_2^5 xe^{x^2} \ dx = \int_{x=2}^{x=5} xe^{x^2} \ dx. \]
When we execute a $u$-substitution, we change the \emph{variable} of integration; it is essential to note that this also changes the \emph{limits} of integration.  For instance, with the substitution $u = x^2$ and $du = 2x \, dx$, it also follows that when $x = 2$, $u = (2)^2 = 4$, and when $x = 5$, $u = (5)^2 = 25.$  Thus, under the change of variables of $u$-substitution, we now have
\begin{eqnarray*}
\int_{x=2}^{x=5} xe^{x^2} \ dx & = & \int_{u=4}^{u=25} e^{u} \cdot \frac{1}{2} \ du \\
& = & \left. \frac{1}{2}e^u \right|_{u=4}^{u=25} \\
& = & \frac{1}{2}e^{25} - \frac{1}{2}e^4.
\end{eqnarray*}

Alternatively, we could consider the related indefinite integral $\int_2^5 xe^{x^2} \, dx,$ find the antiderivative $\frac{1}{2}e^{x^2}$ through $u$-substitution, and then evaluate the original definite integral.  From that perspective, we'd have
\begin{eqnarray*}
\int_{2}^{5} xe^{x^2} \, dx & = & \left. \frac{1}{2}e^{x^2} \right|_{2}^{5} \\
& = & \frac{1}{2}e^{25} - \frac{1}{2}e^4,
\end{eqnarray*}
which is, of course, the same result.

\concept{Substitution with Definite Integrals} %CONCEPT
{Let $f$ and $g$ be differentiable functions, where the range of $g$ is an interval $I$ that contains the domain of $f$. Then \index{integration!definite!and substitution}\index{definite integral!and substitution}
\[ \int_a^b f'\big(g(x)\big)g'(x)\ dx = \int_{g(a)}^{g(b)} f'(u)\ du. \]
} % end concept

Let's look at more examples.

\input{examples/4-6_Eg7} % EXAMPLE

\input{examples/4-6_Eg8} % EXAMPLE

\input{activities/4.6.Act2} % ACTIVITY

\newpage

%-------------
% SUMMARY
%-------------
\begin{summary}
\item To begin to find algebraic formulas for antiderivatives of more complicated algebraic functions, we need to think carefully about how we can reverse known differentiation rules.  To that end, it is essential that we understand and recall known derivatives of basic functions, as well as the standard derivative rules.

\item The indefinite integral provides notation for antiderivatives.  When we write ``$\int f(x) \, dx$,'' we mean ``the general antiderivative of $f$.''  In particular, if we have functions $f$ and $F$ such that $F' = f$, the following two statements say the exact thing:
\[ \frac{d}{dx}[F(x)] = f(x) \ \mbox{and} \ \int f(x) \, dx = F(x) + C. \]
That is, $f$ is the derivative of $F$, and $F$ is an antiderivative of $f$.

\item The technique of $u$-substitution helps us evaluate indefinite integrals of the form 
\[\int f(g(x))g'(x) \, dx\]
through the substitutions $u = g(x)$ and $du = g'(x) \, dx$, so that
\[ \int f(g(x))g'(x) \, dx = \int f(u) \, du. \]
A key part of choosing the expression in $x$ represented by $u$ is the identification of a function-derivative pair.  To do so, we often look for an ``inner'' function $g(x)$ that is part of a composite function, while investigating whether $g'(x)$ (or a constant multiple of $g'(x)$) is present as a multiplying factor of the integrand.
\end{summary}

\clearpage

%--------------
% EXERCISES
%--------------
\input{exercises/4-6.Substitution(Ex)} 

\cleardoublepage