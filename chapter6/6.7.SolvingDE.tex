\section{Separable differential equations} \label{S:6.7.SolvingDE}

\begin{goals}
\item What is a separable differential equation?  
\item How can we find solutions to a separable differential equation?
\item Are some of the differential equations that arise in applications separable?
\item How can we use differential equations to describe and understand 
  phenomena in the world around us?
\end{goals} 

%---------------------------------------------
% SUBSECTION INTRODUCTION
%---------------------------------------------
\subsection*{Introduction}

Given the frequency with which differential equations arise in the world around us, we would like to have some techniques for finding explicit algebraic solutions of certain initial value problems.  In this section, we focus on a particular class of differential equations (called {\em separable}) and develop a method for finding algebraic formulas for solutions to these equations.

A {\em separable differential equation}\index{separable} is a differential equation whose algebraic structure permits the variables present to be separated in a particular way.  For instance, consider the equation
$$ \frac{dy}{dt} = ty. $$
We would like to separate the variables $t$ and $y$ so that all occurrences of $t$ appear on the right-hand side, and all occurrences of $y$ appears on the left and multiply $dy/dt$.  We may do this in the preceding differential equation by dividing both sides by $y$:
$$ \frac1y\frac{dy}{dt} = t. $$
Note particularly that when we attempt to separate the variables in a differential equation, we require that the left-hand side be a product in which the derivative $dy/dt$ is one term.  

Not every differential equation is separable.  For example, if we consider the equation
$$ \frac{dy}{dt} = t-y, $$
it may seem natural to separate it by writing
$$ y + \frac{dy}{dt} = t. $$
As we will see, this will not be helpful since the left-hand side is not a product of a function of $y$ with $\frac{dy}{dt}$.

\input{previews/6.7.PA1} %PREVIEW 

%--------------------------------------------------------------------------------
% SUBSECTION SEPERABLE DIFFERENTIAL EQUATIONS
%--------------------------------------------------------------------------------
\subsection*{Solving separable differential equations} \index{separable}

Before we discuss a general approach to solving a separable differential equation, it is instructive to consider an example.

\input{examples/6-7_Eg1.tex}  %EXAMPLE 

The strategy of Example~\ref{eg:6.7.1} may be applied to any differential equation of the form $\frac{dy}{dt} = g(y) \cdot h(t)$, and any differential equation of this form is said to be \emph{separable}.  We work to solve a separable differential equation by writing
$$\frac{1}{g(y)} \frac{dy}{dt} = h(t),$$ 
and then integrating both sides with respect to $t$.  After integrating, we strive to solve algebraically for $y$ in order to write $y$ as a function of $t$.

We consider one more example before doing further exploration in some activities.

\input{examples/6-7_Eg2.tex}  %EXAMPLE 

\input{activities/6.7.Act1}  %ACTIVITY   

\input{activities/6.7.Act2} %ACTIVITY

\input{activities/6.7.Act3} %ACTIVITY


%--------------------------------------------------------------------------------
% SUBSECTION SEPERABLE DIFFERENTIAL EQUATIONS
%--------------------------------------------------------------------------------
\subsection*{Developing a differential equation}

In our work to date, we have seen several ways that
differential equations arise in the natural world, from the growth of
a population to the temperature of a cup of coffee.  Now,
we will look more closely at how differential equations give us a
natural way to describe various phenoma.  As we'll see, the key is to
focus on understanding the different factors that cause a quantity to
change.

\input{activities/6.7.Act4} % ACTIVITY

Activity~\ref{A:6.7.4} demonstrates the kind of thinking we will be
doing.  In each of the two examples we considered, there is a
quantity, such as the amount of money in the bank account or the
amount of salt in the tank, that is changing due to several factors.
The governing differential equation results from the total rate of change being the difference between the rate of
increase and the rate of decrease.

\input{examples/6-7_Eg3.tex}  % EXAMPLE ***Don't forget the figures!!***

There are many important lessons to learn from Example~\ref{eg:6.7.3}.  Foremost is how we can develop a differential equation by thinking about the ``total rate = rate in - rate out'' model.  In addition, we note how we can bring together all of our available understanding (plotting $\frac{dP}{dt}$ vs. $P$, creating a slope field, solving the differential equation) to see how the differential equation describes the behavior of a changing quantity.

Of course, we can also explore what happens when certain aspects of the problem change.  For instance, let's suppose we are at a time when the plastic pollution entering Lake Michigan has
stabilized at $1.5\cdot10^5$ cubic meters, and that new legislation is
passed to prevent this type of pollution entering the lake.  So, there is no longer any inflow of plastic pollution to the lake.  How does the amount of plastic pollution in Lake Michigan now change?  For example, how long does it take for the amount of plastic pollution in the lake to halve?

Restarting the problem at time $t=0$, we now have the modified initial value problem
$$
\frac{dP}{dt} = -\frac{1}{100}P, \ P(0) = 1.5\cdot10^5.
$$
It is a straightforward and familiar exercise to find that the solution to this equation is $P(t) = 1.5\cdot10^5
e^{-t/100}$.  The time that it takes for half of the pollution to flow
out of the lake is given by $T$ where $P(T) = 0.75\cdot10^5$.  Thus, we must solve the equation
$$0.75\cdot10^5 = 1.5\cdot10^5e^{-T/100},$$
or
$$ \frac12 = e^{-T/100}.$$
It follows that 
$$T = -100\thinspace\ln\left(\frac12\right) \approx 69.3 \quad\hbox{years.}$$

In the activities that follow, we explore some other natural settings in which differential equation model changing quantities.

\input{activities/6.7.finance} %ACTIVITY

\input{activities/6.7.iv.drug} %ACTIVITY


%--------------------------------------------------------------------------------
% SUBSECTION POPULATION GROWTH
%--------------------------------------------------------------------------------
\subsection*{Population Growth}

We will now begin studying the earth's population.  To get started, some data for the earth's population in recent years that we will use in our investigations is given in Table~\ref{T:earthpop}.

\begin{margintable}[6cm]

\begin{center}
\scalebox{1.25}{
  \begin{tabular}{|c|c|}
    \hline
    Year & Population \\
    \hline
    $1998$ & $5.932$ \\
    $1999$ & $6.008$ \\
    $2000$ & $6.084$ \\
    $2001$ & $6.159$ \\
    $2002$ & $6.234$ \\
    $2005$ & $6.456$ \\
    $2006$ & $6.531$ \\
    $2007$ & $6.606$ \\
    $2008$ & $6.681$ \\
    $2009$ & $6.756$ \\
    $2010$ & $6.831$ \\
    \hline
  \end{tabular}
} % end scalebox
\end{center}

\caption{The earth's recent population (in billions).}
\label{T:earthpop}
\end{margintable}

\input{activities/6.7.exponential} %ACTIVITY

Our work in Activity~\ref{A:7.6.1} shows that that the exponential model is fairly accurate for years 
relatively close to $2000$.  However, if we go too far into the
future, the model predicts increasingly large rates of change, which
causes the population to grow arbitrarily large.  This does not make
much sense since it is unrealistic to expect that the earth would be able to support
such a large population.  

The constant $k$ in the differential equation has an important
interpretation.  Let's rewrite the differential equation $\frac{dP}{dt} = kP$ by solving for $k$, so that we have
$$k = \frac{dP/dt}{P}.$$
Viewed in this light, $k$ is the ratio of the rate of change to the
population;  in other words, it is the contribution to the rate of change 
from a single person.  We call this the {\em per capita
  growth rate}\index{per capita growth rate}.

In the exponential model we introduced in Activity~\ref{A:7.6.1}, the per capita growth rate is
constant.  In particular, we are assuming that when the population is
large, the per capita growth rate is the same as when the population
is small.  It is natural to think that the per capita growth rate should
decrease when the population becomes large, since there will not be
enough resources to support so many people.  In other words, we expect that a more realistic model would hold if we assume
that the per capita growth rate depends on the population $P$.

In the previous activity, we computed the per capita growth rate in a
single year by computing $k$, the quotient of $\frac{dP}{dt}$ and $P$ (which we did for $t = 0$).  If we return data and compute the per capita
growth rate over a range of years, we generate the data shown in Figure~\ref{F:6.7.census}-(a), which shows how the per capita growth rate is a function of the population, $P$.  

From the data, we see that the per capita growth rate appears to decrease as
the population increases.  In fact, the points seem to lie very close
to a line, which is shown at two different scales in Figure \ref{F:6.7.census}-(b) and Figure \ref{F:6.7.census}-(c).

\begin{marginfigure}[-6cm] % MARGIN FIGURE
\begin{center}
\subfloat[]{\includegraphics[scale=.75]{figures/7_6_census.eps}}

\subfloat[]{\includegraphics[scale=.75]{figures/7_6_census_1.eps}}

\subfloat[]{\includegraphics[scale=.75]{figures/7_6_census_2.eps}}
\end{center}
\caption{The data and approximations of the per capita growth as a function of population, $P$.}
\label{F:6.7.census}
\end{marginfigure}

Looking at this line carefully, we can find its equation to be
$$
\frac{dP/dt}{P} = 0.025 - 0.002P.
$$
If we multiply both sides by $P$, we arrive at the differential
equation
$$
\frac{dP}{dt} = P(0.025 - 0.002P).
$$
Graphing the dependence of $dP/dt$ on the population $P$, we see that this differential equation demonstrates a quadratic relationship between $\frac{dP}{dt}$ and $P$, as shown in Figure~\ref{F:6.7.logistic}.

The equation $\frac{dP}{dt} = P(0.025 - 0.002P)$ is an example of the {\em logistic equation}, 
and is the second model for population growth that we will consider.  We
have reason to believe that it will be more realistic since the per
capita growth rate is a decreasing function of the population.

Indeed, the graph in Figure~\ref{F:6.7.logistic} shows that there are two equilibrium
solutions, $P=0$, which is unstable, and $P=12.5$, which is a stable
equilibrium.  The graph shows that any solution with $P(0) >0$ will
eventually stabilize around $12.5$.  In other words, our model predicts
the the world's population will eventually stabilize around $12.5$
billion.

\begin{marginfigure}
  \margingraphics{figures/7_6_logistic_de.eps}
  \caption{A plot of $\frac{dP}{dt}$ vs.~$P$ for the differential equation $\frac{dP}{dt} = P(0.025 - 0.002P)$.}
  \label{F:6.7.logistic}
\end{marginfigure}

A prediction for the long-term behavior of the population is a
valuable conclusion to draw from our differential equation.  We would,
however, like to answer some quantitative questions.  For instance,
how long will it take to reach a population of $10$ billion?  To determine this,
we need to find an explicit solution of the equation.  

%--------------------------------------------------------------------------------
% SUBSECTION LOGISTIC DIFFERENTIAL EQUATION
%--------------------------------------------------------------------------------
\subsection*{Solving the logistic differential equation} \index{logistic}

Since we would like to apply the logistic model in more general situations, we state the logistic equation\index{logistic equation} in its more general form,
\begin{equation} \label{E:6.7.logistic}
\frac{dP}{dt} = kP(N-P).
\end{equation}
The equilibrium solutions here are when $P=0$ and $1-\frac PN = 0$,
which shows that $P=N$.  The equilibrium at $P=N$ is called the {\em
  carrying capacity}\index{carrying capacity} of the population for it represents the stable
population that can be sustained by the environment.

We now solve the logistic equation~(\ref{E:6.7.logistic}).  The equation is separable, so we separate the variables
$$
\frac{1}{P(N-P)}\frac{dP}{dt} = k,
$$
and integrate to find that
$$
\int \frac{1}{P(N-P)}~dP = \int k~dt.
$$

To find the antiderivative on the left, we use the partial fraction decomposition
$$
\frac{1}{P(N-P)} = \frac 1N\left[\frac 1P + \frac 1{N-P}\right].
$$
Now we are ready to integrate, with 
$$
\int \frac 1N\left[\frac 1P + \frac 1{N-P}\right] ~dP  =  \int k~dt. 
$$
On the left, observe that $N$ is constant, so we can remove the factor of $\frac{1}{N}$ and antidifferentiate to find that
$$
\frac 1N (\ln|P| - \ln|N-P|)  =  kt + C.
$$
Multiplying both sides of this last equation by $N$ and using an important rule of logarithms, we next find that
$$\ln\left|\frac{P}{N-P}\right| = kNt + C.$$
From the definition of the logarithm, replacing $e^C$ with $C$, and letting $C$ absorb the absolute value signs, we now know that 
$$\frac{P}{N-P} =  Ce^{kNt}.$$
At this point, all that remains is to determine $C$ and solve algebraically for $P$.

If the initial population is $P(0) = P_0$, then it follows that $C = \frac{P_0}{N-P_0}$, so
$$\frac{P}{N-P} = \frac{P_0}{N-P_0}e^{kNt}.$$
We will solve this most recent equation for $P$ by multiplying both sides by
$(N-P)(N-P_0)$ to obtain 
\begin{eqnarray*}
P(N-P_0) &=& P_0(N-P)e^{kNt}  \\
	 &=& P_0Ne^{kNt} - P_0Pe^{kNt}. 
\end{eqnarray*}	 
Swapping the left and right sides, expanding, and factoring, it follows that
\begin{eqnarray*}
P_0Ne^{kNt} & = & P(N-P_0) + P_0 Pe^{kNt}  \\
	& = & P(N-P_0 + P_0e^{kNt}). 
\end{eqnarray*}
Dividing to solve for $P$, we see that
$$P = \frac{P_0Ne^{kNt}}{N-P_0 + P_0e^{kNt}}.$$
Finally, we choose to multiply the numerator and denominator by $\frac{1}{P_0}e^{-kNt}$
to obtain
$$
P(t) = \frac{N}{\left(\frac{N-P_0}{P_0}\right) e^{-kNt} + 1}.
$$

While that was a lot of algebra, notice the result:  we have
found an explicit solution to the initial value problem
$$
  \frac{dP}{dt} = kP(N-P), \ P(0) = P_0,
$$
and that solution\index{logistic equation!solution} is 
\begin{equation}\label{E:7.6.logistic_solution}
P(t) = \frac{N}{\left(\frac{N-P_0}{P_0}\right) e^{-kNt} + 1}.
\end{equation}

For the logistic equation describing the earth's population that we worked with earlier in this section, we have
$$k=0.002, \quad N= 12.5, \quad \hbox{and} \quad P_0 = 6.084.$$
This gives the solution
$$
P(t) = \frac{12.5}{1.0546e^{-0.025t} + 1},
$$
whose graph is shown in Figure~\ref{F:6.7.logistic_sol}
\begin{marginfigure} 
 \margingraphics{figures/7_6_logistic_sol.eps}
\caption{The solution to the logistic equation modeling the earth's population.} \label{F:6.7.logistic_sol}
\end{marginfigure}

Notice that the graph shows the population leveling off at $12.5$ billion, as
we expected, and that the population will be around $10$ billion in the
year $2050$.  These results, which we have found using a relatively simple
mathematical model, agree fairly well with predictions made using a
much more sophisticated model developed by the United Nations.

The logistic equation is useful in other situations, too, as it is good for modeling any situation in which limited growth is possible.  For instance, it could model the spread of a flu virus through a population contained on a cruise ship, the rate at which a rumor spreads within a small town, or the behavior of an animal population on an island.  Again, it is important to realize that through our work in this section, we have completely solved the logistic equation, regardless of the values of the constants $N$, $k$, and $P_0$.  Anytime we encounter a logistic equation, we can apply the formula we found in Equation~(\ref{E:7.6.logistic_solution}).

\input{activities/6.7.logistic} %ACTIVITY


%---------------------
% SUMMARY
%---------------------
\begin{summary}
\item A separable differential equation is one that may be rewritten
  with all occurrences of the dependent variable multiplying the
  derivative and all occurrences of the independent variable on the
  other side of the equation.
\item We may find the solutions to certain separable differential equations
  by separating variables, integrating with respect to $t$, and ultimately solving the resulting algebraic equation for $y$.
 
\item This technique allows us to solve many important differential
  equations that arise in the world around us.  For instance, questions of
  growth and decay and Newton's Law of Cooling give rise to separable
  differential equations.  

\item If we assume that the rate of growth of a population is
  proportional to the population, we are led to a model in which the
  population grows without bound and at a  rate that grows without bound. 
\item By assuming that the per capita growth rate decreases as the
  population grows, we are led to the logistic model of population
  growth, which predicts that the population will eventually
  stabilize at the carrying capacity.    
\end{summary}

\clearpage

%--------------
% EXERCISES
%--------------
\input{exercises/6-7.Seperable(Ex)} 

\cleardoublepage