\section{The Tangent Line Approximation} \label{S:3.6.LinApprox}

\begin{goals}
\item What is the formula for the general tangent line approximation to a differentiable function $y = f(x)$ at the point $(a,f(a))$?
\item What is the principle of local linearity and what is the local linearization of a differentiable function $f$ at a point $(a,f(a))$?
\item How does knowing just the tangent line approximation tell us information about the behavior of the original function itself near the point of approximation?  How does knowing the second derivative's value at this point provide us additional knowledge of the original function's behavior?
\end{goals}

%--------------------------------------
% SUBSECTION INTRODUCTION
%--------------------------------------
\subsection*{Introduction}

Among all functions, linear functions are simplest.  One of the powerful consequences of a function $y = f(x)$ being differentiable at a point $(a,f(a))$ is that, up close, the function $y = f(x)$ is locally linear and looks like its tangent line at that point.  In certain circumstances, this allows us to approximate the original function $f$ with a simpler function $L$ that is linear: this can be advantageous when we have limited information about $f$ or when $f$ is computationally or algebraically complicated.  We will explore all of these situations in what follows.

It is essential to recall that when $f$ is differentiable at $x = a$, the value of $f'(a)$ provides the slope of the tangent line to $y = f(x)$ at the point $(a,f(a))$.  By knowing both a point on the line and the slope of the line we are thus able to find the equation of the tangent line.  Preview Activity~\ref{PA:3.6} will refresh these concepts through a key example and set the stage for further study.

\input{previews/3.6.PA1} % PREVIEW

%--------------------------------------
% SUBSECTION TANGENT LINE	
%--------------------------------------
\subsection*{The tangent line}\index{tangent line!equation}

Given a function $f$ that is differentiable at $x = a$, we know that we can determine the slope of the tangent line to $y = f(x)$ at $(a,f(a))$ by computing $f'(a)$.  The resulting tangent line through $(a,f(a))$ with slope $m = f'(a)$ has its equation in point-slope form given by
$$y - f(a) = f'(a)(x-a),$$
which we can also express as $y = f'(a)(x-a) + f(a)$.  Note well: there is a major difference between $f(a)$ and $f(x)$ in this context.  The former is a constant that results from using the given fixed value of $a$, while the latter is the general expression for the rule that defines the function.  The same is true for $f'(a)$ and $f'(x)$: we must carefully distinguish between these expressions.  Each time we find the tangent line, we need to evaluate the function and its derivative at a fixed $a$-value.


\begin{marginfigure}[1cm] % MARGIN FIGURE
\margingraphics{figures/1_8_TanLine.eps}
\caption{A function $y = f(x)$ and its tangent line at the point $(a,f(a))$: at left, from a distance, and at right, up close.  At right, we label the tangent line function by $y = L(x)$ and observe that for $x $ near $a$, $f(x) \approx L(x)$.} \label{F:3.6.TanLine}
\end{marginfigure}

In Figure~\ref{F:3.6.TanLine}, we see a labeled plot of the graph of a function $f$ and its tangent line at the point $(a,f(a))$.  Notice how when we zoom in we see the local linearity of $f$ more clearly highlighted as the function and its tangent line are nearly indistinguishable up close.  This can also be seen dynamically in the java applet at \href{http://gvsu.edu/s/6J}{\texttt{http://gvsu.edu/s/6J}}.

%--------------------------------------
% SUBSECTION LOCAL LINEARIZATION	
%--------------------------------------
\subsection*{The local linearization} \index{local linearization}

A slight change in perspective and notation will enable us to be more precise in discussing how the tangent line to $y = f(x)$ at $(a,f(a))$ approximates $f$ near $x = a$.  Taking the equation for the tangent line and solving for $y$, we observe that the tangent line is given by
$$y = f'(a)(x-a) + f(a)$$
and moreover that this line is itself a function of $x$.  Replacing the variable $y$ with the expression $L(x)$, we call
$$L(x) = f'(a)(x-a) + f(a)$$
the \emph{local linearization of $f$} at the point $(a,f(a))$.  In this notation, it is particularly important to observe that $L(x)$ is nothing more than a new name for the tangent line, and that for $x$ close to $a$, we have that $f(x) \approx L(x)$.

Say, for example, that we know that a function $y = f(x)$ has its tangent line approximation given by $L(x) = 3 - 2(x-1)$ at the point $(1,3)$, but we do not know anything else about the function $f$.  If we are interested in estimating a value of $f(x)$ for $x$ near $1$, such as $f(1.2)$, we can use the fact that $f(1.2) \approx L(1.2)$ and hence
$$f(1.2) \approx L(1.2) = 3 - 2(1.2-1) = 3 - 2(0.2) = 2.6.$$
Again, much of the new perspective here is only in notation since $y = L(x)$ is simply a new name for the tangent line function.  In light of this new notation and our observations above, we note that since $L(x) = f(a) + f'(a)(x-a)$ and $L(x) \approx f(x)$ for $x$ near $a$, it also follows that we can write
$$f(x) \approx f(a) + f'(a)(x-a) \ \mbox{for} \  x \ \mbox{near} \ a.$$

The next activity explores some additional important properties of the local linearization $y = L(x)$ to a function $f$ at given $a$-value.

\input{activities/3.6.Act1} % ACTIVITY

As we saw in the example provided by Activity~\ref{A:3.6.1}, the local linearization $y = L(x)$ is a linear function that shares two important values with the function $y = f(x)$ that it is derived from.  In particular, observe that since $L(x) = f(a) + f'(a)(x-a)$, it follows that $L(a) = f(a)$.  In addition, since $L$ is a linear function, its derivative is its slope.  Hence, $L'(x) = f'(a)$ for every value of $x$, and specifically $L'(a) = f'(a)$.  Therefore, we see that $L$ is a linear function that has both the same value and the same slope as the function $f$ at the point $(a,f(a))$.

In situations where we know the linear approximation $y = L(x)$, we therefore know the original function's value and slope at the point of tangency.  What remains unknown, however, is the shape of the function $f$ at the point of tangency.  There are essentially four possibilities, as enumerated in Figure~\ref{F:3.6.Options}.  

\begin{marginfigure}[1cm] % MARGIN FIGURE
\margingraphics{figures/1_8_Options.eps}
\caption{Four possible graphs for a nonlinear differentiable function and how it can be situated relative to its tangent line at a point.} \label{F:3.6.Options}
\end{marginfigure}

These stem from the fact that there are three options for the value of the second derivative:  either $f''(a) <0$, $f''(a) = 0$, or $f''(a) > 0$.  If $f''(a) > 0$, then we know the graph of $f$ is concave up, and we see the first possibility on the left, where the tangent line lies entirely below the curve.  If $f''(a) < 0$, then we find ourselves in the second situation (from left) where $f$ is concave down and the tangent line lies above the curve.  In the situation where $f''(a) = 0$ and $f''$ changes sign at $x = a$, the concavity of the graph will change, and we will see either the third or fourth option\footnote{It is possible to have $f''(a) = 0$ and have $f''$ not change sign at $x = a$, in which case the graph will look like one of the first two options.}.  A fifth option (that is not very interesting) can occur, which is where the function $f$ is linear, and so $f(x) = L(x)$ for all values of $x$.

The plots in Figure~\ref{F:3.6.Options} highlight yet another important thing that we can learn from the concavity of the graph near the point of tangency: whether the tangent line lies above or below the curve itself.  This is key because it tells us whether or not the tangent line approximation's values will be too large or too small in comparison to the true value of $f$.  For instance, in the first situation in the leftmost plot in Figure~\ref{F:3.6.Options} where $f''(a) > 0$, since the tangent line falls below the curve, we know that $L(x) \le f(x)$ for all values of $x$ near $a$.

We explore these ideas further in the following activity.

\input{activities/3.6.Act2} % ACTIVITY

The idea that a differentiable function looks linear and can be well-approximated by a linear function is an important one that finds wide application in calculus.  For example, by approximating a function with its local linearization, it is possible to develop an effective algorithm to estimate the zeroes of a function.  Local linearity also helps us to make further sense of certain challenging limits.  For instance, we have seen that a limit such as
$$\lim_{x \to 0} \frac{\sin(x)}{x}$$
is indeterminate because both its numerator and denominator tend to $0$.  While there is no algebra that we can do to simplify $\frac{\sin(x)}{x}$, it is straightforward to show that the linearization of $f(x) = \sin(x)$ at the point $(0,0)$ is given by $L(x) = x$.  Hence, for values of $x$ near $0$, $\sin(x) \approx x$.  As such, for values of $x$ near $0$, 
$$\frac{\sin(x)}{x} \approx \frac{x}{x} = 1,$$
which makes plausible the fact that $$\lim_{x \to 0} \frac{\sin(x)}{x} = 1.$$
These ideas and other applications of local linearity will be explored later on in our work.

%--------------------------------------
% SUBSECTION DIFFERENTIALS
%--------------------------------------
\subsection*{Differentials}

Recall that the derivative of a function $f$ can be used to find the slopes of lines tangent to the graph of $f$. At $x=a$, the tangent line to the graph of $f$ has equation $$y = f(a) + \fp(a)(x-a).$$
The tangent line can be used to find good approximations of $f(x)$ for values of $x$ near $a$. 

%For instance, we can approximate $\sin 1.1$ using the tangent line to the graph of $f(x)=\sin x$ at $x=\pi/3 \approx 1.05.$ Recall that $\sin (\pi/3) = \sqrt{3}/2 \approx 0.866$, and $\cos (\pi/3) = 1/2$. Thus the tangent line to $f(x) = \sin x$ at $x=\pi/3$ is: $$ \ell(x) = \frac12(x-\pi/3)+0.866.$$
%
%\begin{marginfigure}[-6cm] % MARGIN FIGURE
%\subfloat[]{\margingraphics{figures/figdiffal1a}}
%
%\subfloat[]{\margingraphics{figures/figdiffal1}}
%\caption{Graphing $f(x) = \sin x$ and its tangent line at $x=\pi/3$ in order to estimate $\sin 1.1$.}\label{fig:diffal1}
%\end{marginfigure}
%
%In Figure \ref{fig:diffal1}(a), we see a graph of $f(x) = \sin x$ graphed along with its tangent line at $x=\pi/3$. The small rectangle shows the region that is displayed in Figure \ref{fig:diffal1}(b). In this figure, we see how we are approximating $\sin 1.1$ with the tangent line, evaluated at $1.1$. Together, the two figures show how close these values are.
%
%Using this line to approximate $\sin 1.1$, we have:
%\begin{align*}
%\ell(1.1) &= \frac12(1.1-\pi/3)+0.866 \\
%&= \frac12(0.053)+0.866 = 0.8925.
%\end{align*}
%(We leave it to the reader to see how good of an approximation this is.)

We now generalize this concept. Given $f(x)$ and an $x$--value $a$,  the tangent line is $L(x) = f(a) + \fp(a)(x-a)$. Clearly, $L(a) = f(a)$. Let $\dx$ be a small number, representing a small change in $x$ value. We assert that:
$$f(a+\dx) \approx L(a+\dx),$$ since the tangent line to a function approximates well the values of that function near $x=a$. 

As the $x$ value changes from $a$ to $a+\dx$, the $y$ value of $f$ changes from $f(a)$ to $f(a+\dx)$. We call this change of $y$ value $\dy$. That is:
$$\dy = f(a+\dx)-f(a).$$
Replacing $f(a+\dx)$ with its tangent line approximation, we have 
\begin{align} \dy &\approx L(a+\dx) - f(a) \notag\\
&= \fp(a)\big((a+\dx)-a\big)+f(a) - f(a)\notag \\
&=\fp(a)\dx		\label{eq:differential}
\end{align}

This final equation is important; we'll come back to it in a moment.

We introduce two new variables, $dx$ and $dy$ in the context of a formal definition. %We defined $dx = \dx$; that is, it is a small change in $x$. We define

\definition{Differentials of $x$ and $y$} % DEFINITION
{Let $y=f(x)$ be differentiable. The \textbf{differential of $x$}, denoted $dx$, is any nonzero real number (usually taken to be a small number).\index{differential}\index{derivative!differential} The \textbf{differential of $y$}, denoted $dy$, is $$dy = \fp(x)dx.$$
} % end definition

It is helpful to organize our new concepts and notations in one place.

\concept{Differential Notation\index{differential!notation}} % CONCEPT
{Let $y = f(x)$ be a differentiable function. 
\ba
\item $\dx$ represents a small, nonzero change in $x$ value.
\item $dx$ represents a small, nonzero change in $x$ value (i.e., $\dx = dx$).
\item $\dy$ is the change in $y$ value as $x$ changes by $\dx$; hence $$\dy = f(x+\dx)-f(x).$$
\item $dy = \fp(x)dx$ which, by Equation (\ref{eq:differential}), is an \textit{approximation} of the change in $y$ value as $x$ changes by $\dx$; $dy \approx \dy$; see Figure~\ref{fig:differentials}.
\ea
} % end concept

\begin{marginfigure}[-3cm] % MARGIN FIGURE
\margingraphics{figs/3/differentials.pdf}
\caption{A graph describing the relationship of differentials.}
\label{fig:differentials}
\end{marginfigure}

What is the value of differentials? Like many mathematical concepts, differentials provide both practical and theoretical benefits. We explore both here.

\input{examples/3-6_Eg1.tex} % EXAMPLE

Of course, it is easy to compute the actual answer (by hand or with a calculator): $3.1^2 = 9.61.$ (Before we get too cynical and say ``Then why bother?'', note our approximation is \textit{really} good!)

So why bother?

In ``most'' real life situations, we do not know the function that describes a particular behavior. Instead, we can only take measurements of how things change -- measurements of the derivative.

Imagine water flowing down a winding channel. It is easy to measure the speed and direction (i.e., the \textit{velocity}) of water at any location. It is very hard to create a function that describes the overall flow, hence it is hard to predict where a floating object placed at the beginning of the channel will end up. However, we can \textit{approximate} the path of an object using differentials. Over small intervals, the path taken by a floating object is essentially linear. Differentials allow us to approximate the true path by piecing together lots of short, linear paths. This technique is called Euler's Method, studied in introductory Differential Equations courses.

We use differentials once more to approximate the value of a function. Even though calculators are very accessible, it is neat to see how these techniques can sometimes be used to easily compute something that looks rather hard.

\input{examples/3-6_Eg2.tex} % EXAMPLE

Differentials are important when we discuss \textit{integration}. When we study that topic, we will use notation such as $$\int f(x)\ dx$$ quite often. While we don't discuss here what all of that notation means, note the existence of the differential $dx$. Proper handling of \textit{integrals} comes with proper handling of differentials. 

In light of that, we practice finding differentials in general.

\input{examples/3-6_Eg3.tex} % EXAMPLE

Finding the differential $dy$ of $y=f(x)$ is really no harder than finding the derivative of $f$; we just \textit{multiply} $\fp(x)$ by $dx$. It is important to remember that we are not simply adding the symbol ``$dx$'' at the end.

We have seen a practical use of differentials as they offer a good method of making certain approximations. Another use is \textit{error propagation.} Suppose a length is measured to be $x$, although the actual value is $x+\dx$ (where we hope $\dx$ is small). This measurement of $x$ may be used to compute some other value; we can think of this as $f(x)$ for some function $f$. As the true length is $x+\dx$, one really should have computed $f(x+\dx)$. The difference between $f(x)$ and $f(x+\dx)$ is the propagated error. 

How close are $f(x)$ and $f(x+\dx)$? This is a difference in ``y'' values; $$f(x+\dx)-f(x) = \dy \approx dy.$$ We can approximate the propagated error using differentials.

\input{examples/3-6_Eg4.tex} % EXAMPLE

\clearpage

%-------------
% SUMMARY
%-------------
\begin{summary}
\item The tangent line to a differentiable function $y = f(x)$ at the point $(a,f(a))$ is given in point-slope form by the equation
$$y - f(a) = f'(a)(x-a).$$
\item The principle of local linearity tells us that if we zoom in on a point where a function $y = f(x)$ is differentiable, the function should become indistinguishable from its tangent line.  That is, a differentiable function looks linear when viewed up close.  We rename the tangent line to be the function $y = L(x)$ where $L(x) = f(a) + f'(a)(x-a)$ and note that $f(x) \approx L(x)$ for all $x$ near $x = a$.
\item If we know the tangent line approximation $L(x) = f(a) + f'(a)(x-a)$, then because $L(a) = f(a)$ and $L'(a) = f'(a)$, we also know both the value and the derivative of the function $y = f(x)$ at the point where $x = a$.  In other words, the linear approximation tells us the height and slope of the original function.  If, in addition, we know the value of $f''(a)$, we then know whether the tangent line lies above or below the graph of $y = f(x)$ depending on the concavity of $f$.
\end{summary}

\clearpage

%--------------
% EXERCISES
%--------------
\input{exercises/3-6.Tangent(Ex)} 

\cleardoublepage