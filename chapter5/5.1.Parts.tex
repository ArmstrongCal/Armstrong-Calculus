The previous chapter introduced the antiderivative and connected it to signed areas under a curve through the Fundamental Theorem of Calculus. The next chapter explores more applications of definite integrals than just area. As evaluating definite integrals will become important, we will want to find antiderivatives of a variety of functions.

This chapter is devoted to exploring techniques of antidifferentiation. While not every function has an antiderivative in terms of elementary functions, % we need to say what these are.
 we can still find antiderivatives of many.

%***************************
% SECTION INTEGRATION BY PARTS
%***************************
\section{Integration by Parts} \label{S:5.1.Parts}

\begin{goals}
\item How do we evaluate indefinite integrals that involve products of basic functions such as $\int x \sin(x) \, dx$ and $\int x e^x \, dx$?
\item What is the method of integration by parts and how can we consistently apply it to integrate products of basic functions?
\item How does the algebraic structure of functions guide us in identifying $u$ and $dv$ in using integration by parts?
\end{goals}

%-----------------------------------
%SUBSECTION: INTRODUCTION
%-----------------------------------
\subsection*{Introduction}

In Section~\ref{S:4.6.Substitution}, we learned the technique of $u$-substitution for evaluating indefinite integrals that involve certain composite functions.  For example, the indefinite integral $\int x^3 \sin(x^4) \, dx$ is perfectly suited to $u$-substitution, since not only is there a composite function present, but there is also a {\em function-derivative} pair that allows us to rewrite the composite function so that we may integrate.  Through $u$-substitution, we learned a general situation where recognizing the algebraic structure of a function can enable us to find its antiderivative.  

It is natural to ask similar questions to those we considered in Section~\ref{S:4.6.Substitution} about functions with a different elementary algebraic structure:  those that are the product of basic functions.  For instance, suppose we are interested in evaluating the indefinite integral
$$\int x \sin(x) \, dx.$$
Here, there is not a composite function present, but rather a product of the basic functions $f(x) = x$ and $g(x) = \sin(x)$.  From our work in Section~\ref{S:2.5.ProdQuot} with the Product Rule, we know that it is relatively complicated to compute the derivative of the product of two functions, so we should expect that antidifferentiating a product should be similarly involved.  In addition, intuitively we expect that evaluating $\int x \sin(x) \, dx$ will involve somehow reversing the Product Rule.

To that end, in Preview Activity~\ref{PA:5.1} we refresh our understanding of the Product Rule and then investigate some indefinite integrals that involve products of basic functions.

\input{previews/5.1.PA1} %PREVIEW

%---------------------------------------------
% SUBSECTION INTEGRATION BY PARTS
%---------------------------------------------
\subsection*{Reversing the Product Rule: Integration by Parts} \index{integration by parts}

Problem (c) in Preview Activity~\ref{PA:5.1} provides a clue for how we develop the general technique known as Integration by Parts, which comes from reversing the Product Rule.  Recall that the Product Rule states that
$$\frac{d}{dx} \left[ f(x) g(x) \right] = f(x) g'(x) + g(x)  f'(x).$$
Integrating both sides of this equation indefinitely with respect to $x$, it follows that
\begin{equation} \label{E:intprod}
\int \frac{d}{dx} \left[ f(x)  g(x) \right] \, dx = \int f(x) g'(x) \, dx + \int g(x)  f'(x) \, dx.
\end{equation}
On the left in Equation~(\ref{E:intprod}), we recognize that we have the indefinite integral of the derivative of a function which, up to an additional constant, is the original function itself.  Temporarily omitting the constant that may arise, we equivalently have 
\begin{equation} \label{E:intprod2}
f(x)  g(x) = \int f(x) g'(x) \, dx + \int g(x)  f'(x) \, dx.
\end{equation}
The most important thing to observe about Equation~(\ref{E:intprod2}) is that it provides us with a choice of two integrals to evaluate.  That is, in a situation where we can identify two functions $f$ and $g$, if we can integrate $f(x) g'(x)$, then we know the indefinite integral of $g(x) f'(x)$, and vice versa.  To that end, we choose the first indefinite integral on the left in Equation~(\ref{E:intprod2}) and solve for it to generate the rule
\begin{equation} \label{E:IBP1}
\int f(x) g'(x) \, dx  = f(x)  g(x) -  \int g(x)  f'(x) \, dx.
\end{equation}
Often we express Equation~(\ref{E:IBP1}) in terms of the variables $u$ and $v$, where $u = f(x)$ and $v = g(x)$.  Note that in differential notation, $du = f'(x) \, dx$ and $dv = g'(x) \, dx$, and thus we can state the rule for Integration by Parts in its most common form as follows.

\concept{Integration by Parts} %CONCEPT
{Let $u$ and $v$ be differentiable functions of $x$ on an interval $I$ containing $a$ and $b$. Then 
$$\int u\ dv = uv - \int v\ du,$$ and \index{integration!by parts}
$$\int_{x=a}^{x=b} u\ dv = uv\Big|_a^b - \int_{x=a}^{x=b}v\ du.$$
} %END CONCEPT

To apply Integration by Parts, we look for a product of basic functions that we can identify as $u$ and $dv$.  If we can antidifferentiate $dv$ to find $v$, and evaluating $\int v \, du$ is not more difficult than evaluating $\int u \, dv$, then this substitution usually proves to be fruitful.  To demonstrate, we consider the following example.

\input{examples/5-1_Eg1} % EXAMPLE

There are at least two additional important observations to make from Example~\ref{eg:5.1.1}.  First, the general technique of Integration by Parts involves trading the problem of integrating the product of two functions for the problem of integrating the product of two related functions.  In particular, we convert the problem of evaluating $\int u \, dv$ for that of evaluating $\int v \, du$.  This perspective clearly shapes our choice of $u$ and $v$.  In  Example~\ref{eg:5.1.1}, the original integral to evaluate was $\int x \cos(x) \,dx$, and through the substitution provided by Integration by Parts, we were instead able to evaluate $\int \sin(x) \cdot 1 \, dx$.  Note that the original function $x$ was replaced by its derivative, while $\cos(x)$ was replaced by its antiderivative.  Second, observe that when we get to the final stage of evaluating the last remaining antiderivative, it is at this step that we include the integration constant, $+C$.  

\marginnote[4cm]{A useful mnemonic for helping to determine $u$ is ``LIATE,'' where 
\begin{center}L = \textbf{L}ogarithmic, I = \textbf{I}nverse Trig., A = \textbf{A}lgebraic (polynomials), 
T = \textbf{T}rigonometric, and E = \textbf{E}xponential.
\end{center}
If the integrand contains both a logarithmic and an algebraic term, in general letting $u$ be the logarithmic term works best, as indicated by L coming before A in LIATE.}

\input{examples/5-1_Eg2} % EXAMPLE

\input{activities/5.1.Act1} %ACTIVITY

%-------------------------------------------------------------------
% SUBSECTION SUBTLETIES WITH INTEGRATION BY PARTS
%-------------------------------------------------------------------
\subsection*{Some Subtleties with Integration by Parts}

There are situations where Integration by Parts is not an obvious choice, but the technique is appropriate nonetheless.  One guide to understanding why is the observation that integration by parts allows us to replace one function in a product with its derivative while replacing the other with its antiderivative.  For instance, consider the problem of evaluating 
$$\int \arctan(x) \, dx.$$
Initially, this problem seems ill-suited to Integration by Parts since there does not appear to be a product of functions present.  But if we note that $\arctan(x) = \arctan(x) \cdot 1$, and realize that we know the derivative of $\arctan(x)$ as well as the antiderivative of $1$, we see the possibility for the substitution $u = \arctan(x)$ and $dv = 1 \, dx$.  We explore this substitution further in Activity~\ref{A:5.1.2}.

In a related problem, if we consider $\int t^3 \sin(t^2) \, dt$, two key observations can be made about the algebraic structure of the integrand:  there is a composite function present in $\sin(t^2)$, and there is not an obvious function-derivative pair, as we have $t^3$ present (rather than simply $t$) multiplying $\sin(t^2)$.  This problem exemplifies the situation where we sometimes use both $u$-substitution and Integration by Parts in a single problem.  If we write $t^3 = t \cdot t^2$ and consider the indefinite integral
$$\int t \cdot t^2 \cdot \sin(t^2) \, dt,$$
we can use a mix of the two techniques we have recently learned.  First, let $z = t^2$ so that $dz = 2t \, dt$, and thus $t \, dt = \frac{1}{2} \, dz$.  (We are using the variable $z$ to perform a ``$z$-substitution'' since $u$ will be used subsequently in executing Integration by Parts.)  Under this $z$-substitution, we now have 
$$\int t \cdot t^2 \cdot \sin(t^2) \, dt = \int z \cdot \sin(z) \cdot \frac{1}{2} \, dz.$$
The remaining integral is a standard one that can be evaluated by parts.  This, too, is explored further in Activity~\ref{A:5.1.2}.

The problems briefly introduced here exemplify that we sometimes must think creatively in choosing the variables for substitution in Integration by Parts, as well as that it is entirely possible that we will need to use the technique of substitution for an additional change of variables within the process of integrating by parts.  

\input{examples/5-1_Eg3} % EXAMPLE

\input{activities/5.1.Act2} %ACTIVITY

%-------------------------------------------------------------------------
% SUBSECTION USING INTEGRATION BY PARTS MULTIPLE TIMES
%-------------------------------------------------------------------------
\subsection*{Using Integration by Parts Multiple Times} 

We have seen that the technique of Integration by Parts is well suited to integrating the product of basic functions, and that it allows us to essentially trade a given integrand for a new one where one function in the product is replaced by its derivative, while the other is replaced by its antiderivative.  The main goal in this trade of $\int u \, dv$ for $\int v \, du$ is to have the new integral not be more challenging to evaluate than the original one.  At times, it turns out that it can be necessary to apply Integration by Parts more than once in order to ultimately evaluate a given indefinite integral.

For example, if we consider $\int t^2 e^t \, dt$ and let $u = t^2$ and $dv = e^t \, dt$, then it follows that  $du = 2t \, dt$ and $v = e^t$, thus
$$\int t^2 e^t \, dt = t^2 e^t - \int 2t e^t \, dt.$$
The integral on the righthand side is simpler to evaluate than the one on the left, but it still requires Integration by Parts.  Now letting $u = 2t$ and $dv = e^t \, dt$, we have $du = 2\, dt$ and $v = e^t$, so that 
$$\int t^2 e^t \, dt = t^2 e^t - \left( 2t e^t - \int 2 e^t \, dt \right).$$
Note the key role of the parentheses, as it is essential to distribute the minus sign to the entire value of the integral $\int 2t e^t \, dt$.  The final integral on the right in the most recent equation is a basic one; evaluating that integral and distributing the minus sign, we find
$$\int t^2 e^t \, dt = t^2 e^t - 2t e^t +  2 e^t + C.$$

Of course, situations are possible where even more than two applications of Integration by Parts may be necessary.  For instance, in the preceding example, it is apparent that if the integrand was $t^3e^t$ instead, we would have to use Integration by Parts three times.

Next, we consider the slightly different scenario presented by the definite integral $\int e^t \cos(t) \, dt$.  Here, we can choose to let $u$ be either $e^t$ or $\cos(t)$; we pick $u = \cos(t)$, and thus $dv = e^t \, dt$.  With $du = -\sin(t) \, dt$ and $v = e^t$, Integration by Parts tells us that
$$\int e^t \cos(t) \, dt = e^t \cos(t) - \int e^t (-\sin(t))\, dt,$$
or equivalently that
\begin{equation} \label{E:IBPtwice}
\int e^t \cos(t) \, dt = e^t \cos(t) + \int e^t \sin(t) \, dt
\end{equation}
Observe that the integral on the right in Equation~(\ref{E:IBPtwice}), \\ $\int e^t \sin(t) \, dt$, while not being more complicated than the original integral we want to evaluate, it is essentially identical to $\int e^t \cos(t) \, dt$.  While the overall situation isn't necessarily better than what we started with, the problem hasn't gotten worse.  Thus, we proceed by integrating by parts again.  This time we let $u = \sin(t)$ and $dv = e^t \, dt$, so that $du = \cos(t) \, dt$ and $v = e^t$, which implies
\begin{equation} \label{E:IBPtwice2}
\int e^t \cos(t) \, dt = e^t \cos(t) + \left( e^t \sin(t) - \int e^t \cos(t) \, dt \right)
\end{equation}
We seem to be back where we started, as two applications of Integration by Parts has led us back to the original problem, $\int e^t \cos(t) \, dt$.  But if we look closely at Equation~(\ref{E:IBPtwice2}), we see that we can use algebra to solve for the value of the desired integral.  In particular, adding $\int e^t \cos(t) \, dt$ to both sides of the equation, we have 
$$2 \int e^t \cos(t) \, dt = e^t \cos(t) +  e^t \sin(t),$$
and therefore 
$$ \int e^t \cos(t) \, dt = \frac{1}{2} \left( e^t \cos(t) +  e^t \sin(t) \right) + C.$$
\marginnote[-1cm]{This is the result we used in Example~\ref{eg:5.1.3}. }
Note that since we never actually encountered an integral we could evaluate directly, we didn't have the opportunity to add the integration constant $C$ until the final step, at which point we include it as part of the most general antiderivative that we sought from the outset in evaluating an indefinite integral.

\input{examples/5-1_Eg4} % EXAMPLE

\input{activities/5.1.Act3} %ACTIVITY

%------------------------------------------------------------------------------
% SUBSECTION DEFINITE INTEGRALS USING INTEGRATION BY PARTS 
%------------------------------------------------------------------------------
\subsection*{Evaluating Definite Integrals Using Integration by Parts} 

Just as we saw with $u$-substitution in Section~\ref{S:4.6.Substitution}, we can use the technique of Integration by Parts to evaluate a definite integral.  Say, for example, we wish to find the exact value of 
$$\int_0^{\pi/2} t\sin(t) \, dt.$$
One option is to evaluate the related indefinite integral to find that $\int t\sin(t) \, dt = -t \cos(t) + \sin(t) + C,$ and then use the resulting antiderivative along with the Fundamental Theorem of Calculus to find that \small
\begin{eqnarray*}
  \int_0^{\pi/2} t\sin(t) \, dt & = & \left( -t \cos(t) + \sin(t) \right) \bigg\vert_0^{\pi/2} \\
  					& = & \left( -\frac{\pi}{2} \cos\left(\frac{\pi}{2}\right) + \sin\left(\frac{\pi}{2}\right) \right) - \left( -0 \cos(0) + \sin(0) \right) \\
					& = & 1.
\end{eqnarray*} \normalsize

Alternatively, we can apply Integration by Parts and work with definite integrals throughout.  In this perspective, it is essential to remember to evaluate the product $uv$ over the given limits of integration.  To that end, using the substitution $u = t$ and $dv = \sin(t) \, dt$, so that $du = dt$ and $v = -\cos(t)$, we write \small
\begin{eqnarray*}
  \int_0^{\pi/2} t\sin(t) \, dt & = &  -t \cos(t) \bigg\vert_0^{\pi/2} - \int_0^{\pi/2} (-\cos(t)) \, dt \\
  					& = &  -t \cos(t) \bigg\vert_0^{\pi/2}  +  \sin(t) \bigg\vert_0^{\pi/2}  \\
					& = & \left( -\frac{\pi}{2} \cos\left(\frac{\pi}{2}\right) + \sin\left(\frac{\pi}{2}\right) \right) - \left( -0 \cos(0) + \sin(0) \right) \\
					& = & 1.					
\end{eqnarray*} \normalsize
As with any substitution technique, it is important to remember the overall goal of the problem, to use notation carefully and completely, and to think about our end result to ensure that it makes sense in the context of the question being answered.

\input{examples/5-1_Eg5} % EXAMPLE

%-------------------------------------------------------------------------------------------------
% SUBSECTION WHEN U-SUBSTITUTION AND INTEGRATION BY PARTS FAILS TO HELP 
%-------------------------------------------------------------------------------------------------
\subsection*{When $u$-substitution and Integration by Parts Fail to Help}

As we close this section, it is important to note that both integration techniques we have discussed apply in relatively limited circumstances.  In particular, it is not hard to find examples of functions for which neither technique produces an antiderivative; indeed, there are many, many functions that appear elementary but that do not have an elementary algebraic antiderivative.  For instance, if we consider the indefinite integrals
$$\int e^{x^2} \, dx \ \ \mbox{and} \ \ \int x \tan(x) \, dx,$$
neither $u$-substitution nor Integration by Parts proves fruitful.  

While there are other integration techniques, some of which we will consider briefly, none of them enables us to find an algebraic antiderivative for $e^{x^2}$ or $x \tan(x)$.  There are at least two key observations to make:  one, we do know from the Fundamental Theorem of Calculus that we can construct an integral antiderivative for each function; and two, antidifferentiation is much, much harder in general than differentiation.  In particular, we observe that $F(x) = \int_0^x e^{t^2} \, dt$ is an antiderivative of $f(x) = e^{x^2}$, and $G(x) = \int_0^{x} t \tan(t) \, dt$ is an antiderivative of $g(x) = x \tan(x)$.  But finding an elementary algebraic formula that doesn't involve integrals for either $F$ or $G$ turns out not only to be impossible through $u$-substitution or Integration by Parts, but indeed impossible altogether.

\clearpage

%-------------
% SUMMARY
%-------------
\begin{summary}
\item Through the method of Integration by Parts, we can evaluate indefinite integrals that involve products of basic functions such as $\int x \sin(x) \, dx$ and $\int x \ln(x) \, dx$ through a substitution that enables us to effectively trade one of the functions in the product for its derivative, and the other for its antiderivative, in an effort to find a different product of functions that is easier to integrate.
\item If we are given an integral whose algebraic structure we can identify as a product of basic functions in the form $\int f(x) g'(x) \, dx$, we can use the substitution $u = f(x)$ and $dv = g'(x) \,dx$ and apply the rule
$$\int u \, dv = uv - \int v \, du$$
in an effort to evaluate the original integral $\int f(x) g'(x) \, dx$ by instead evaluating $\int v \, du = \int f'(x) g(x) \, dx$.
\item When deciding to integrate by parts, we normally have a product of functions present in the integrand and we have to select both $u$ and $dv$.  That selection is guided by the overall principal that we desire the new integral $\int v \, du$ to not be any more difficult or complicated than the original integral $\int u \, dv$.  In addition, it is often helpful to recognize if one of the functions present is much easier to differentiate than antidifferentiate (such as $\ln(x)$), in which case that function often is best assigned the variable $u$.  For sure, when choosing $dv$, the corresponding function must be one that we can antidifferentiate.
\end{summary}

\clearpage

%--------------
% EXERCISES
%--------------
\input{exercises/5-1.Parts(Ex)} 

\cleardoublepage